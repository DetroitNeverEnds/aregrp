{
  "openapi": "3.1.0",
  "info": {
    "title": "API",
    "version": "1.0.0",
    "description": "Main API for the project"
  },
  "paths": {
    "/api/v1/auth/register": {
      "post": {
        "operationId": "apps_accounts_routers_auth_register",
        "summary": "Register",
        "parameters": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthOut"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorOut"
                }
              }
            }
          }
        },
        "description": "Регистрация нового пользователя\n\nСоздает нового пользователя в системе с указанными данными.\nАвтоматически генерирует API токен и JWT токены для аутентификации.\n\n**Параметры:**\n- `username`: Имя пользователя (уникальное)\n- `email`: Email адрес (уникальный)\n- `password1`: Пароль\n- `password2`: Подтверждение пароля\n- `use_cookies`: Установить токены в HTTP-Only cookies (опционально)\n\n**Пример запроса:**\n```json\n{\n    \"username\": \"testuser\",\n    \"email\": \"test@example.com\",\n    \"password1\": \"securepassword123\",\n    \"password2\": \"securepassword123\",\n    \"use_cookies\": false\n}\n\n**Пример ответа:**\n```json\n{\n    \"user\": {\n        \"id\": 1,\n        \"username\": \"testuser\",\n        \"email\": \"test@example.com\"\n    },\n    \"access_token\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...\",\n    \"refresh_token\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...\",\n    \"message\": \"User successfully registered\",\n    \"use_cookies\": false\n}\n```\n\n**Коды ошибок:**\n- `400`: Пароли не совпадают, пользователь уже существует, ошибка валидации пароля",
        "tags": [
          "Authentication"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UserRegistrationIn"
              }
            }
          },
          "required": true
        }
      }
    },
    "/api/v1/auth/login": {
      "post": {
        "operationId": "apps_accounts_routers_auth_login_user",
        "summary": "Login User",
        "parameters": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthOut"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorOut"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorOut"
                }
              }
            }
          }
        },
        "description": "Вход в систему\n\nАутентифицирует пользователя по имени пользователя и паролю.\nВозвращает JWT токены для доступа к защищенным эндпоинтам.\n\n**Параметры:**\n- `username`: Имя пользователя\n- `password`: Пароль\n- `use_cookies`: Установить токены в HTTP-Only cookies (опционально)\n\n**Пример запроса:**\n```json\n{\n    \"username\": \"testuser\",\n    \"password\": \"securepassword123\",\n    \"use_cookies\": false\n}\n```\n\n**Пример ответа:**\n```json\n{\n    \"user\": {\n        \"id\": 1,\n        \"username\": \"testuser\",\n        \"email\": \"test@example.com\"\n    },\n    \"access_token\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...\",\n    \"refresh_token\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...\",\n    \"message\": \"Login successful\",\n    \"use_cookies\": false\n}\n```\n\n**Коды ошибок:**\n- `400`: Ошибка сервера\n- `401`: Неверные учетные данные",
        "tags": [
          "Authentication"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UserLoginIn"
              }
            }
          },
          "required": true
        }
      }
    },
    "/api/v1/auth/logout": {
      "post": {
        "operationId": "apps_accounts_routers_auth_logout_user",
        "summary": "Logout User",
        "parameters": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "title": "Response",
                  "type": "object"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorOut"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorOut"
                }
              }
            }
          }
        },
        "description": "Выход из системы\n\nОчищает HTTP-Only cookies и завершает сессию пользователя.\nУдаляет access и refresh токены из cookies.\n\n**Требует аутентификации:** Bearer JWT токен в заголовке Authorization\n\n**Пример запроса:**\n```\nPOST /api/v1/auth/logout\nAuthorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...\n```\n\n**Пример ответа:**\n```json\n{\n    \"message\": \"Logout successful\"\n}\n```\n\n**Коды ошибок:**\n- `401`: Не авторизован",
        "tags": [
          "Authentication"
        ],
        "security": [
          {
            "JWTAuth": []
          }
        ]
      }
    },
    "/api/v1/auth/refresh-token": {
      "post": {
        "operationId": "apps_accounts_routers_auth_refresh_token",
        "summary": "Refresh Token",
        "parameters": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "title": "Response",
                  "type": "object"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorOut"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorOut"
                }
              }
            }
          }
        },
        "description": "Обновить JWT токены\n\nОбновляет access и refresh токены используя refresh токен из HTTP-Only cookies.\nУстанавливает новые токены обратно в cookies.\n\n**Требует:** Refresh токен в HTTP-Only cookie\n\n**Пример запроса:**\n```\nPOST /api/v1/auth/refresh-token\nCookie: refresh_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...\n```\n\n**Пример ответа:**\n```json\n{\n    \"message\": \"Tokens refreshed successfully\",\n    \"access_token\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...\",\n    \"refresh_token\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...\"\n}\n```\n\n**Коды ошибок:**\n- `401`: Refresh токен не найден, истек или неверный",
        "tags": [
          "Authentication"
        ]
      }
    },
    "/api/v1/auth/password-reset": {
      "post": {
        "operationId": "apps_accounts_routers_auth_password_reset",
        "summary": "Password Reset",
        "parameters": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "title": "Response",
                  "type": "object"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorOut"
                }
              }
            }
          }
        },
        "description": "Запрос сброса пароля\n\nОтправляет email с токеном для сброса пароля на указанный email адрес.\nЕсли пользователь с таким email не найден, возвращает успешный ответ\n(для безопасности не раскрываем информацию о существовании пользователя).\n\n**Параметры:**\n- `email`: Email адрес пользователя\n\n**Пример запроса:**\n```json\n{\n    \"email\": \"user@example.com\"\n}\n```\n\n**Пример ответа:**\n```json\n{\n    \"message\": \"If an account with this email exists, a password reset link has been sent.\"\n}\n```\n\n**Коды ошибок:**\n- `400`: Ошибка отправки email",
        "tags": [
          "Authentication"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PasswordResetIn"
              }
            }
          },
          "required": true
        }
      }
    },
    "/api/v1/auth/password-reset/confirm": {
      "post": {
        "operationId": "apps_accounts_routers_auth_password_reset_confirm",
        "summary": "Password Reset Confirm",
        "parameters": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "title": "Response",
                  "type": "object"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorOut"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorOut"
                }
              }
            }
          }
        },
        "description": "Подтверждение сброса пароля\n\nУстанавливает новый пароль используя токен из email.\n\n**Параметры:**\n- `token`: JWT токен для сброса пароля (из email)\n- `new_password1`: Новый пароль\n- `new_password2`: Подтверждение нового пароля\n\n**Пример запроса:**\n```json\n{\n    \"token\": \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...\",\n    \"new_password1\": \"newpassword123\",\n    \"new_password2\": \"newpassword123\"\n}\n```\n\n**Пример ответа:**\n```json\n{\n    \"message\": \"Password has been reset successfully\"\n}\n```\n\n**Коды ошибок:**\n- `400`: Пароли не совпадают, ошибка валидации пароля, неверный токен\n- `401`: Токен истек или неверный",
        "tags": [
          "Authentication"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/PasswordResetConfirmIn"
              }
            }
          },
          "required": true
        }
      }
    },
    "/api/v1/profile/user": {
      "get": {
        "operationId": "apps_accounts_routers_profile_get_user",
        "summary": "Get User",
        "parameters": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserOut"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorOut"
                }
              }
            }
          }
        },
        "description": "Получить данные текущего пользователя\n\nВозвращает полную информацию о текущем авторизованном пользователе,\nвключая API токен, тарифный план и статистику использования.\n\n**Требует аутентификации:** Bearer JWT токен в заголовке Authorization\n\n**Пример запроса:**\n```\nGET /api/v1/profile/user\nAuthorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...\n```\n\n**Пример ответа:**\n```json\n{\n    \"id\": 1,\n    \"username\": \"testuser\",\n    \"email\": \"test@example.com\"\n}\n```\n\n**Коды ошибок:**\n- `401`: Не авторизован (отсутствует или неверный JWT токен)",
        "tags": [
          "Profile"
        ],
        "security": [
          {
            "JWTAuth": []
          }
        ]
      }
    },
    "/api/v1/profile/profile": {
      "put": {
        "operationId": "apps_accounts_routers_profile_update_profile",
        "summary": "Update Profile",
        "parameters": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserOut"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorOut"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorOut"
                }
              }
            }
          }
        },
        "description": "Обновить профиль пользователя\n\nОбновляет информацию профиля текущего авторизованного пользователя.\nМожно обновить имя пользователя и/или email адрес.\n\n**Требует аутентификации:** Bearer JWT токен в заголовке Authorization\n\n**Параметры:**\n- `username`: Новое имя пользователя (опционально)\n- `email`: Новый email адрес (опционально)\n\n**Пример запроса:**\n```\nPUT /api/v1/profile/profile\nAuthorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...\nContent-Type: application/json\n\n{\n    \"username\": \"newusername\",\n    \"email\": \"newemail@example.com\"\n}\n```\n\n**Пример ответа:**\n```json\n{\n    \"id\": 1,\n    \"username\": \"newusername\",\n    \"email\": \"newemail@example.com\"\n}\n```\n\n**Коды ошибок:**\n- `400`: Ошибка обновления (например, имя пользователя уже занято)\n- `401`: Не авторизован",
        "tags": [
          "Profile"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateProfileIn"
              }
            }
          },
          "required": true
        },
        "security": [
          {
            "JWTAuth": []
          }
        ]
      }
    },
    "/api/v1/profile/change-password": {
      "post": {
        "operationId": "apps_accounts_routers_profile_change_password",
        "summary": "Change Password",
        "parameters": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "additionalProperties": true,
                  "title": "Response",
                  "type": "object"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorOut"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorOut"
                }
              }
            }
          }
        },
        "description": "Смена пароля авторизованным пользователем\n\nПозволяет авторизованному пользователю изменить свой пароль.\nТребует указания текущего пароля для подтверждения.\n\n**Требует аутентификации:** Bearer JWT токен в заголовке Authorization\n\n**Параметры:**\n- `current_password`: Текущий пароль пользователя\n- `new_password1`: Новый пароль\n- `new_password2`: Подтверждение нового пароля\n\n**Пример запроса:**\n```\nPOST /api/v1/profile/change-password\nAuthorization: Bearer eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9...\nContent-Type: application/json\n\n{\n    \"current_password\": \"oldpassword123\",\n    \"new_password1\": \"newpassword123\",\n    \"new_password2\": \"newpassword123\"\n}\n```\n\n**Пример ответа:**\n```json\n{\n    \"message\": \"Password changed successfully\"\n}\n```\n\n**Коды ошибок:**\n- `400`: Пароли не совпадают, неверный текущий пароль, ошибка валидации пароля\n- `401`: Не авторизован",
        "tags": [
          "Profile"
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdatePasswordIn"
              }
            }
          },
          "required": true
        },
        "security": [
          {
            "JWTAuth": []
          }
        ]
      }
    }
  },
  "components": {
    "schemas": {
      "AuthOut": {
        "properties": {
          "user": {
            "$ref": "#/components/schemas/UserOut"
          },
          "access_token": {
            "title": "Access Token",
            "type": "string"
          },
          "refresh_token": {
            "title": "Refresh Token",
            "type": "string"
          },
          "message": {
            "title": "Message",
            "type": "string"
          },
          "use_cookies": {
            "title": "Use Cookies",
            "type": "boolean"
          }
        },
        "required": [
          "user",
          "access_token",
          "refresh_token",
          "message",
          "use_cookies"
        ],
        "title": "AuthOut",
        "type": "object"
      },
      "UserOut": {
        "properties": {
          "id": {
            "title": "Id",
            "type": "integer"
          },
          "username": {
            "title": "Username",
            "type": "string"
          },
          "email": {
            "title": "Email",
            "type": "string"
          }
        },
        "required": [
          "id",
          "username",
          "email"
        ],
        "title": "UserOut",
        "type": "object"
      },
      "ErrorOut": {
        "properties": {
          "error": {
            "title": "Error",
            "type": "string"
          },
          "message": {
            "title": "Message",
            "type": "string"
          }
        },
        "required": [
          "error",
          "message"
        ],
        "title": "ErrorOut",
        "type": "object"
      },
      "UserRegistrationIn": {
        "properties": {
          "username": {
            "title": "Username",
            "type": "string"
          },
          "email": {
            "title": "Email",
            "type": "string"
          },
          "password1": {
            "title": "Password1",
            "type": "string"
          },
          "password2": {
            "title": "Password2",
            "type": "string"
          },
          "use_cookies": {
            "default": false,
            "title": "Use Cookies",
            "type": "boolean"
          }
        },
        "required": [
          "username",
          "email",
          "password1",
          "password2"
        ],
        "title": "UserRegistrationIn",
        "type": "object"
      },
      "UserLoginIn": {
        "properties": {
          "username": {
            "title": "Username",
            "type": "string"
          },
          "password": {
            "title": "Password",
            "type": "string"
          },
          "use_cookies": {
            "default": false,
            "title": "Use Cookies",
            "type": "boolean"
          }
        },
        "required": [
          "username",
          "password"
        ],
        "title": "UserLoginIn",
        "type": "object"
      },
      "PasswordResetIn": {
        "properties": {
          "email": {
            "title": "Email",
            "type": "string"
          }
        },
        "required": [
          "email"
        ],
        "title": "PasswordResetIn",
        "type": "object"
      },
      "PasswordResetConfirmIn": {
        "properties": {
          "token": {
            "title": "Token",
            "type": "string"
          },
          "new_password1": {
            "title": "New Password1",
            "type": "string"
          },
          "new_password2": {
            "title": "New Password2",
            "type": "string"
          }
        },
        "required": [
          "token",
          "new_password1",
          "new_password2"
        ],
        "title": "PasswordResetConfirmIn",
        "type": "object"
      },
      "UpdateProfileIn": {
        "properties": {
          "username": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Username"
          },
          "email": {
            "anyOf": [
              {
                "type": "string"
              },
              {
                "type": "null"
              }
            ],
            "title": "Email"
          }
        },
        "title": "UpdateProfileIn",
        "type": "object"
      },
      "UpdatePasswordIn": {
        "properties": {
          "current_password": {
            "title": "Current Password",
            "type": "string"
          },
          "new_password1": {
            "title": "New Password1",
            "type": "string"
          },
          "new_password2": {
            "title": "New Password2",
            "type": "string"
          }
        },
        "required": [
          "current_password",
          "new_password1",
          "new_password2"
        ],
        "title": "UpdatePasswordIn",
        "type": "object"
      }
    },
    "securitySchemes": {
      "JWTAuth": {
        "type": "http",
        "scheme": "bearer"
      }
    }
  },
  "servers": []
}